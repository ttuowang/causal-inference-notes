<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Sensitivity Analysis II | Causal Inference</title>
  <meta name="description" content="This is the notes of Causal Inference. Most of the materials come from STAT 992 instructed by Prof. Kang and from several textbooks in causal inference" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Sensitivity Analysis II | Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the notes of Causal Inference. Most of the materials come from STAT 992 instructed by Prof. Kang and from several textbooks in causal inference" />
  <meta name="github-repo" content="ttuowang/causal-inference-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Sensitivity Analysis II | Causal Inference" />
  
  <meta name="twitter:description" content="This is the notes of Causal Inference. Most of the materials come from STAT 992 instructed by Prof. Kang and from several textbooks in causal inference" />
  

<meta name="author" content="Tuo Wang" />


<meta name="date" content="2020-10-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="models.html"/>
<link rel="next" href="iv.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causal Inference</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="basic.html"><a href="basic.html"><i class="fa fa-check"></i><b>1</b> Propensity score</a></li>
<li class="chapter" data-level="2" data-path="matching.html"><a href="matching.html"><i class="fa fa-check"></i><b>2</b> Matching</a><ul>
<li class="chapter" data-level="2.1" data-path="matching.html"><a href="matching.html#what-is-matching"><i class="fa fa-check"></i><b>2.1</b> What is matching?</a></li>
<li class="chapter" data-level="2.2" data-path="matching.html"><a href="matching.html#exact-matching"><i class="fa fa-check"></i><b>2.2</b> Exact Matching</a></li>
<li class="chapter" data-level="2.3" data-path="matching.html"><a href="matching.html#propensity-score-matching"><i class="fa fa-check"></i><b>2.3</b> Propensity Score Matching</a></li>
<li class="chapter" data-level="2.4" data-path="matching.html"><a href="matching.html#multivariate-caliper-matching"><i class="fa fa-check"></i><b>2.4</b> Multivariate Caliper Matching</a><ul>
<li class="chapter" data-level="2.4.1" data-path="matching.html"><a href="matching.html#a-mahalanobis-distances"><i class="fa fa-check"></i><b>2.4.1</b> (a) Mahalanobis Distances</a></li>
<li class="chapter" data-level="2.4.2" data-path="matching.html"><a href="matching.html#b-penalize-large-distance"><i class="fa fa-check"></i><b>2.4.2</b> (b) Penalize large distance</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="matching.html"><a href="matching.html#matching-with-multiple-controls"><i class="fa fa-check"></i><b>2.5</b> Matching with Multiple controls</a></li>
<li class="chapter" data-level="2.6" data-path="matching.html"><a href="matching.html#full-matching"><i class="fa fa-check"></i><b>2.6</b> Full Matching</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sensitivity1.html"><a href="sensitivity1.html"><i class="fa fa-check"></i><b>3</b> Sensitivity Analysis I</a><ul>
<li class="chapter" data-level="3.1" data-path="sensitivity1.html"><a href="sensitivity1.html#sensitivity-analysis-for-matched-sets-with-binary-outcomes"><i class="fa fa-check"></i><b>3.1</b> Sensitivity Analysis for Matched Sets with Binary Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>4</b> causal Inference with Models</a><ul>
<li class="chapter" data-level="4.1" data-path="models.html"><a href="models.html#ipw-estimator"><i class="fa fa-check"></i><b>4.1</b> IPW estimator</a></li>
<li class="chapter" data-level="4.2" data-path="models.html"><a href="models.html#outcome-regression"><i class="fa fa-check"></i><b>4.2</b> Outcome Regression</a></li>
<li class="chapter" data-level="4.3" data-path="models.html"><a href="models.html#doubly-robust-estimator"><i class="fa fa-check"></i><b>4.3</b> Doubly robust estimator</a></li>
<li class="chapter" data-level="4.4" data-path="models.html"><a href="models.html#asymptotic-variance"><i class="fa fa-check"></i><b>4.4</b> Asymptotic variance</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sensitivity2.html"><a href="sensitivity2.html"><i class="fa fa-check"></i><b>5</b> Sensitivity Analysis II</a><ul>
<li class="chapter" data-level="5.1" data-path="sensitivity2.html"><a href="sensitivity2.html#e-value"><i class="fa fa-check"></i><b>5.1</b> E-value</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="iv.html"><a href="iv.html"><i class="fa fa-check"></i><b>6</b> Instrumental Variable</a><ul>
<li class="chapter" data-level="6.1" data-path="iv.html"><a href="iv.html#iv-without-covariates-x"><i class="fa fa-check"></i><b>6.1</b> IV without covariates X</a></li>
<li class="chapter" data-level="6.2" data-path="iv.html"><a href="iv.html#iv-with-covariates-x"><i class="fa fa-check"></i><b>6.2</b> IV with covariates X</a></li>
<li class="chapter" data-level="6.3" data-path="iv.html"><a href="iv.html#new-topics-in-i.v."><i class="fa fa-check"></i><b>6.3</b> New topics in I.V.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="m-estimator.html"><a href="m-estimator.html"><i class="fa fa-check"></i><b>7</b> notes on M-estimator</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sensitivity2" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Sensitivity Analysis II</h1>
<p><strong>Reference:</strong></p>
<ul>
<li>Peng and Tyler (2014), “Generalized Cornfield conditions for the risk difference”</li>
<li>Peng and Tyler (2016), “Sensitivity Analysis Without Assumptions”</li>
<li>Tyler and Peng (2017), “Sensitivity Analysis in Observational Research: Introducing the E-Value”</li>
</ul>
<p>This chapter will cover the following topics:</p>
<ul>
<li>E-values</li>
<li>Sensitivity analysis for IPW, OR and DR estimators.</li>
</ul>
<p>A central question in causal inference with observational studies is the sensitivity of conclusions to unmeasured confounding.</p>
<p>First we introduce three variables to describe causal effect:</p>
<ul>
<li>Risk Difference = <span class="math display">\[\tau = \mathbb{E}[Y_i(1) - Y_i(0)] = \mathbb{P}(Y_i(1)=1)-\mathbb{P}(Y_i(0)=1)\]</span></li>
<li>Relative Risk (RR) = <span class="math display">\[\frac{\mathbb{P}(Y_i(1)=1)}{\mathbb{P}(Y_i(0)=1)}\]</span> e.g. RR=3 means treatment causal increases the probability of <span class="math inline">\(Y=1\)</span> by a factor of 3</li>
<li>Odds Ratio (OR) = <span class="math display">\[\frac{\mathbb{P}(Y_i(1)=1)}{1-\mathbb{P}(Y_i(1)=1)}\bigg/\frac{\mathbb{P}(Y_i(0)=1)}{1-\mathbb{P}(Y_i(0)=1)}\]</span> e.g. OR=3 means treatment causal increases the odss of <span class="math inline">\(Y=1\)</span> by 3 fold.</li>
</ul>
<p><strong>Goal:</strong> we want to assess what happens to estimators of <span class="math inline">\(tau\)</span> and RR when an observed confounder <span class="math inline">\(U\)</span> is present</p>
<p>Review the assumptions:</p>
<ul>
<li>SUTUA: <span class="math inline">\(Y_i = A_iY_i(1) + (1-A_i)Y_i(0)\)</span></li>
<li>Conditional ignorability: <span class="math inline">\(Y_i(1),Y_i(0) \perp A_i |X_i\)</span></li>
<li><span class="math inline">\(0 &lt;&lt; P(A_i=1|X_i=x) &lt;&lt;1 \,\,\forall x\)</span></li>
</ul>
<p>When <span class="math inline">\(U\)</span> is present, the assumptions becomes:</p>
<ul>
<li>Conditional ignorability: <span class="math inline">\(Y_i(1),Y_i(0) \perp A_i |X_i, U_i\)</span></li>
<li><span class="math inline">\(0 &lt;&lt; P(A_i=1|X_i=x, U_i=u) &lt;&lt;1 \,\,\forall x,u\)</span></li>
</ul>
<p><strong>Graphically:</strong></p>
<p>Let <span class="math inline">\(RR_{AY}\)</span> be the relative risk of treatment on outcome. Let <span class="math inline">\(RR_{UA}\)</span> be the relative risk of confounder on treatment. Let <span class="math inline">\(RR_{UY}\)</span> be the relative risk of confounder on outcome. In the presence of <span class="math inline">\(U\)</span>, our estimators of <span class="math inline">\(tau\)</span> and RR are biased. We want to measure how much is this bias.</p>
<p><strong>Define:</strong>
<span class="math display">\[B =\frac{RR_{AU}RR_{UY}}{RR_{AU}+RR_{UY}-1}\]</span>
<strong>Theorem:</strong>
<span class="math display">\[RR_{AY} \geq \frac{\hat{RR}}{B}\]</span>
Note that:</p>
<ul>
<li>This bound is sharp.</li>
<li><span class="math inline">\(U\)</span> can be any type (one dimension and multi-dimension).</li>
<li>This formula can also be applied on the lower bound of the confidence interval.</li>
</ul>
<p>Example: Study the causal effect of baby formula (A=1) on respiratory death (Y=1)</p>
<ul>
<li><span class="math inline">\(\hat{RR} = 3.9\)</span>, 95% CI:(1.8,8.7)</li>
<li>They controlled for age, …. (Xs)</li>
</ul>
<p>What if there is an <span class="math inline">\(U\)</span>? How would this <span class="math inline">\(U\)</span> change the result?</p>
<p><span class="math inline">\(\exists U\)</span> s.t. <span class="math inline">\(RR_{UA} = 2\)</span>, probability of taking infants formula increase 2 and <span class="math inline">\(RR_{UY} = 4\)</span> If <span class="math inline">\(U=1\)</span>, then baby is 4 times more likely to die than if <span class="math inline">\(U=0\)</span>. Then
<span class="math display">\[RR_{AY} \geq \frac{3.9}{1.6} = 2.43\]</span> and <span class="math display">\[L_{AY} \geq \frac{\hat{L}_{AY}}{B} = \frac{1.8}{1.6} = 1.125\]</span></p>
<div id="e-value" class="section level2">
<h2><span class="header-section-number">5.1</span> E-value</h2>
<p>Suppose <span class="math inline">\(RR_{UA} = RR_{UY}\)</span>, then <span class="math inline">\(B = \frac{RR_{UA}^2}{2RR_{UA} -1}\)</span>. Then consider the point in the lower bound where <span class="math inline">\(RR_{AY} = 1\)</span>,</p>
<p><span class="math display">\[1 = RR_{AY} \geq \frac{\hat{RR}}{B} = \frac{\hat{RR}}{\frac{RR_{AU}^2}{2RR_{AU} -1}}\]</span>
Solve for <span class="math inline">\(RR_{UA}\)</span>, we get the
<span class="math display">\[\text{E-value}=\hat{RR} + \sqrt{\hat{RR}(\hat{RR}-1)}\]</span>
Note that:</p>
<ul>
<li>Higher E-value means the study is more robust to unmeasured U.</li>
<li>E-calue is the minimum strength of assoication on the risk ratio scale, that an unmeasured confounder would need to have with both the treatment and outcome, conditional on the measured covariates, to explain away a treatment-outcome association.</li>
<li>E-value is a continuous measure of an association’s robustness to potential uncontrolled condounders. The lowerst possible E-value is 1 (that is, no unmeasured confounding is needed to explain away the observed association). The higher the E-value, the stronger the confounder associations must be to explain away the effect.i</li>
</ul>
<p><strong>Risk difference <span class="math inline">\(\tau\)</span>:</strong> Let <span class="math inline">\(\hat{\tau}\)</span> be the estimator, Y binary, <span class="math inline">\(p_1 = \mathbb{P}(Y_i = 1|A_i=1)\)</span>, <span class="math inline">\(p_0 = \mathbb{P}(Y_i = 1|A_i=0)\)</span> and <span class="math inline">\(f = P(A_i=1)\)</span>.</p>
<p><strong>Theorem:</strong>
<span class="math display">\[\tau_{AY} \geq (p_1 - Bp_0)\sqrt{f + \frac{1-f}{B}}\]</span></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="iv.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-sensitivity-analysis-2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["causual-inference-notes.pdf", "causual-inference-notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
